<!DOCTYPE html>
<html th:replace="~{fragments/layout :: layout(~{::head},~{::main})}">
<head th:replace="~{fragments/head :: head(~{})}"></head>

<body>
    <main class="container">
        <br><br>
        <div class="container">
            <h1>Cadastro de Consulta</h1>
            <hr>

            <form th:action="@{${consulta.id == null} ? '/consulta/save' : '/consulta/update'}" th:object="${consulta}" method="post">
                <input type="hidden" th:field="*{id}">
                <input th:field="*{paciente.id}" id="id-paciente" type="hidden">
                <div class="row">
                    <div class="col-md-6">
                        <label>Pesquisar Paciente:</label>
                        <input th:field="*{paciente.nome}" class="form-control" type="text" id="input-paciente" placeholder="Pesquise o Paciente" th:errorclass="is-invalid">
                    </div>


                    <div class="col-md-6">
                        <label>Médico: </label>
                        <select id="medico" name="medico" th:field="*{medico.id}" class="form-select">
                            <option value="">Selecione...</option>
                            <option th:each="m : ${medico}"
                                    th:value="${m.id}"
                                    th:text="${m.nome}">
                            </option>
                        </select>
                    </div>


                </div>
                <br>
                <div class="row">
                    <div class="col-md-6">
                        <label>Valor da Consulta: </label>
                        <input class="form-control" type="text" th:field="*{valor}"  placeholder="Valor">
                    </div>



                    <div class="col-md-6">
                        <label>Data da consulta: </label>
                        <input class="form-control" type="datetime-local" th:field="*{data}" placeholder="data">
                    </div>
                </div>
                <br>

                <div class="col-12">
                    <label>Observação:</label>
                    <input class="form-control" type="text" th:field="*{observacao}"  placeholder="Observacao" th:errorclass="is-invalid">
                </div>
                <div class="invalid-feedback" th:if="${#fields.hasErrors('observacao')}"
                     th:errors="*{observacao}"></div>
                <br>

                <a class="btn btn-sm btn-primary elevate" href="/consulta/list">Voltar</a>

                <input class="btn btn-success btn-sm elevate" type="submit" value="Enviar">
                <div th:each="erro : ${#fields.detailedErrors()}">
                    <span th:text="${erro.fieldName}+' '+${erro.message}"></span>
                </div>

            </form>
        </div>



        <section id="fundo" class="modal-wrapper">
            <div id="modal" class="card" style="">
                <div class="d-flex justify-content-between">
                    <div class="col-md-8">
                        <input id="filtra-paciente" class="form-control" type="text" placeholder="Nome do Paciente">
                    </div>
                    <button class="btn btn-sm" type="button" id="btn-close"><img src="/images/close.svg"></button>
                </div>
                <br>
                <table id="table-pacientes" class="table table-sm " border="1">
                    <thead class="table-dark">
                    <tr>
                        <th>Nome</th>
                        <th>Telefone</th>
                        <th>CPF</th>
                    </tr>
                    </thead>
                    <tr th:attr="onclick=|capturaPaciente('${p.id}', '${p.nome}' )|"  th:each="p : ${paciente}">
                        <td th:text="${p.nome}"></td>
                        <td th:text="${p.telefone}"></td>
                        <td th:text="${p.cpf}"></td>
                    </tr>
                </table>
            </div>
        </section>



    </main>

</body>
</html>
